<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>èƒŒæ™¯ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºè¨ˆç®—æ©Ÿ</title>
    <style>
      body {
        /* åˆæœŸèƒŒæ™¯ç”»åƒã¨ç¹°ã‚Šè¿”ã—è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆONã« */
        background-image: url("images/akipassport.png");
        background-color: #ffffff;
        background-repeat: repeat; /* åˆæœŸå€¤ï¼šç¹°ã‚Šè¿”ã— */
        background-size: 150px; /* åˆæœŸå€¤ï¼šã‚µã‚¤ã‚ºå›ºå®š */
        background-position: center;
        background-attachment: fixed;
        transition: background-image 0.5s ease;
        font-family: "Helvetica Neue", Arial, sans-serif;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
      }

      #site-nav {
        text-align: center;
        padding: 10px;
        margin-bottom: 20px;
        background-color: rgba(255, 255, 255, 0.8);
        border-radius: 50px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        display: flex;
        gap: 5px;
        z-index: 100;
      }

      .nav-link {
        display: inline-block;
        padding: 10px 20px;
        text-decoration: none;
        color: #555;
        border-radius: 25px;
        font-size: 0.85rem;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .nav-link.active {
        background-color: #4385f4;
        color: white !important;
      }

      .container {
        background-color: rgba(255, 255, 255, 0.7);
        width: 70%;
        max-width: 350px;
        padding: 30px;
        border-radius: 16px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        z-index: 10;
        box-sizing: border-box;
      }

      @media (min-width: 600px) {
        .container {
          width: 350px;
        }
      }

      h3 {
        margin-top: 0;
        color: #333;
        text-align: center;
        margin-bottom: 20px;
      }
      label {
        display: block;
        margin-top: 15px;
        font-size: 0.85rem;
        font-weight: bold;
        color: #555;
        margin-bottom: 5px;
      }

      input[type="text"],
      input[type="number"] {
        width: 100%;
        padding: 12px;
        margin-bottom: 5px;
        box-sizing: border-box;
        border: 2px solid #eee;
        border-radius: 8px;
        font-size: 1rem;
        outline: none;
      }

      .file-input {
        width: 100%;
        margin-bottom: 15px;
        font-size: 0.8rem;
      }

      .btn {
        width: 100%;
        padding: 12px;
        margin-top: 5px;
        border: none;
        border-radius: 8px;
        background-color: #007bff;
        color: white;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .btn:hover {
        background-color: #0056b3;
      }
      /* ç¹°ã‚Šè¿”ã—ONçŠ¶æ…‹ã®ãƒœã‚¿ãƒ³è‰² */
      .btn-pattern-active {
        background-color: #28a745;
      }

      .result-area {
        margin-top: 30px;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 12px;
        text-align: center;
      }
      .result {
        font-weight: 900;
        color: #007bff;
        font-size: 1.8rem;
      }
    </style>
  </head>
  <body>
    <nav id="site-nav">
      <a href="index.html" class="nav-link">ãƒ¡ã‚¤ãƒ³è¨ˆç®—æ©Ÿ</a>
      <a href="chasepankun.html" class="nav-link">ãƒ‘ãƒ³ãã‚“ã‚’è¿½ãˆ</a>
      <a href="index1.html" class="nav-link">Ver.1</a>
      <a href="index2.html" class="nav-link">Ver.2</a>
    </nav>

    <div class="container">
      <h3>ğŸ’° èƒŒæ™¯ãƒã‚§ãƒ³ã‚¸è¨ˆç®—æ©Ÿ</h3>

      <label>å˜ä¾¡ (Ã—1000å††)</label>
      <input
        type="text"
        id="price"
        placeholder="ä¾‹: 3"
        onchange="processPrice()"
      />

      <label>å€‹æ•°</label>
      <input type="number" id="quantity" value="1" oninput="calculate()" />

      <label>èƒŒæ™¯ç”»åƒã‚’é¸æŠ</label>
      <input
        type="file"
        id="bgInput"
        class="file-input"
        accept="image/*"
        onchange="changeBackground()"
      />

      <button
        id="patternBtn"
        class="btn btn-pattern-active"
        onclick="togglePattern()"
      >
        ç¹°ã‚Šè¿”ã—è¡¨ç¤º OFF
      </button>

      <div class="result-area">
        <span id="total" class="result">0</span
        ><span style="margin-left: 5px">å††</span>
      </div>
    </div>

    <script>
      // --- 1. ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ãŸæ™‚ã®åˆæœŸè¨­å®š ---
      window.addEventListener("DOMContentLoaded", () => {
        // ç¾åœ¨é–‹ã„ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆä¾‹ï¼šindex.htmlï¼‰ã‚’å–å¾—ã—ã¾ã™
        const currentFile =
          window.location.pathname.split("/").pop() || "index.html";
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ãƒªãƒ³ã‚¯ï¼ˆ.nav-linkï¼‰ã‚’ã™ã¹ã¦é›†ã‚ã¾ã™
        const links = document.querySelectorAll(".nav-link");

        links.forEach((link) => {
          // ã‚‚ã—ãƒªãƒ³ã‚¯å…ˆã®åå‰ãŒã€ä»Šé–‹ã„ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ãªã‚‰
          if (link.getAttribute("href") === currentFile) {
            // ãã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã€Œactiveï¼ˆä»Šã“ã“ã ã‚ˆï¼ï¼‰ã€ã¨ã„ã†å°ã‚’ã¤ã‘ã¾ã™
            link.classList.add("active");
          }
        });
      });

      // èƒŒæ™¯ã‚’ã€Œç¹°ã‚Šè¿”ã—è¡¨ç¤ºã€ã™ã‚‹ã‹ã©ã†ã‹ã®çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹ã‚¹ã‚¤ãƒƒãƒï¼ˆåˆæœŸå€¤ã¯ONï¼‰
      let isPatternMode = true;

      // --- 2. å˜ä¾¡ã‚’å…¥åŠ›ã—ãŸæ™‚ã®å‡¦ç† ---
      function processPrice() {
        const priceInput = document.getElementById("price");
        // å…¥åŠ›ã•ã‚ŒãŸæ–‡å­—ã‹ã‚‰æ•°å­—ä»¥å¤–ï¼ˆå††ãªã©ï¼‰ã‚’å‰Šé™¤ã—ã¦æ•°å­—ã ã‘ã«ã—ã¾ã™
        let val = priceInput.value.replace(/[^0-9]/g, "");

        if (val !== "") {
          // æ•°å­—ã«1000ã‚’æ›ã‘ã¦ã€ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã®è¦‹ã‚„ã™ã„å½¢å¼ã«ã—ã¦å…¥åŠ›æ¬„ã«æˆ»ã—ã¾ã™
          priceInput.value = (Number(val) * 1000).toLocaleString();
        }
        // é‡‘é¡ãŒå¤‰ã‚ã£ãŸã®ã§åˆè¨ˆã‚’å†è¨ˆç®—ã—ã¾ã™
        calculate();
      }

      // --- 3. åˆè¨ˆé‡‘é¡ã‚’è¨ˆç®—ã™ã‚‹å‡¦ç† ---
      function calculate() {
        // å…¥åŠ›æ¬„ã®ã‚«ãƒ³ãƒã‚’æ¶ˆã—ã¦ã€è¨ˆç®—ã§ãã‚‹ã€Œç´”ç²‹ãªæ•°å­—ã€ã‚’å–ã‚Šå‡ºã—ã¾ã™
        const priceVal = document
          .getElementById("price")
          .value.replace(/,/g, "");
        // å€‹æ•°ã®æ¬„ã®æ•°å­—ã‚’å–å¾—ã—ã¾ã™
        const quantityVal = document.getElementById("quantity").value;
        // ã€Œå˜ä¾¡ Ã— å€‹æ•°ã€ã‚’è¨ˆç®—ã—ã¾ã™
        const total = Number(priceVal) * Number(quantityVal);

        const totalElement = document.getElementById("total");
        // åˆè¨ˆé‡‘é¡ã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã«ã—ã¦ç”»é¢ã«è¡¨ç¤ºã—ã¾ã™
        totalElement.innerText = total.toLocaleString();
        // 1ä¸‡å††ä»¥ä¸Šãªã‚‰èµ¤è‰²ã€ãã‚Œä»¥å¤–ãªã‚‰é’è‰²ã«æ–‡å­—è‰²ã‚’å¤‰ãˆã¾ã™
        totalElement.style.color = total >= 10000 ? "#e74c3c" : "#007bff";
      }

      // --- 4. èƒŒæ™¯ç”»åƒã‚’å¤‰ãˆã‚‹å‡¦ç† ---
      function changeBackground() {
        const fileInput = document.getElementById("bgInput");
        const file = fileInput.files[0]; // é¸æŠã•ã‚ŒãŸ1æšç›®ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–ã‚Šå‡ºã™

        if (file) {
          const reader = new FileReader(); // ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã®æº–å‚™
          reader.onload = (e) => {
            // èª­ã¿è¾¼ã¿ãŒçµ‚ã‚ã£ãŸã‚‰ã€ãƒšãƒ¼ã‚¸å…¨ä½“ã®èƒŒæ™¯ã«ãã®ç”»åƒã‚’ã‚»ãƒƒãƒˆã—ã¾ã™
            document.body.style.backgroundImage = `url('${e.target.result}')`;
            // ç¾åœ¨ã®ã€Œç¹°ã‚Šè¿”ã—ON/OFFã€ã®çŠ¶æ…‹ã‚’æ–°ã—ã„ç”»åƒã«ã‚‚é©ç”¨ã—ã¾ã™
            applyBackgroundStyle();
          };
          // ç”»åƒã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦èª­ã¿è¾¼ã¿é–‹å§‹
          reader.readAsDataURL(file);
        }
      }

      // --- 5. ç¹°ã‚Šè¿”ã—ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚ã®å‡¦ç† ---
      function togglePattern() {
        // ã‚¹ã‚¤ãƒƒãƒã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ï¼ˆONãªã‚‰OFFã«ã€OFFãªã‚‰ONã«ï¼‰
        isPatternMode = !isPatternMode;
        // ç”»é¢ã®è¦‹ãŸç›®ã«ã‚¹ã‚¤ãƒƒãƒã®çŠ¶æ…‹ã‚’åæ˜ ã•ã›ã¾ã™
        applyBackgroundStyle();
      }

      // --- 6. èƒŒæ™¯ã®è¦‹ãŸç›®ã‚’å®Ÿéš›ã«å¤‰æ›´ã™ã‚‹å‡¦ç† ---
      function applyBackgroundStyle() {
        const btn = document.getElementById("patternBtn");

        if (isPatternMode) {
          // ã€ç¹°ã‚Šè¿”ã—ONã®å ´åˆã€‘ç”»åƒã‚’150pxã®ã‚µã‚¤ã‚ºã§ä¸¦ã¹ã¦è¡¨ç¤ºã—ã¾ã™
          document.body.style.backgroundRepeat = "repeat";
          document.body.style.backgroundSize = "150px";
          btn.innerText = "ç¹°ã‚Šè¿”ã—è¡¨ç¤º OFF"; // ãƒœã‚¿ãƒ³ã®æ–‡å­—ã‚’æ¬¡ã«ã™ã‚‹ã“ã¨ã«å¤‰æ›´
          btn.classList.add("btn-pattern-active"); // ãƒœã‚¿ãƒ³ã‚’ç·‘è‰²ã«ã—ã¾ã™
        } else {
          // ã€ç¹°ã‚Šè¿”ã—OFFã®å ´åˆã€‘ç”»åƒã‚’ç”»é¢ã«åã¾ã‚‹ã‚ˆã†ã«1æšã ã‘è¡¨ç¤ºã—ã¾ã™
          document.body.style.backgroundRepeat = "no-repeat";
          document.body.style.backgroundSize = "contain";
          btn.innerText = "ç¹°ã‚Šè¿”ã—è¡¨ç¤º ON"; // ãƒœã‚¿ãƒ³ã®æ–‡å­—ã‚’æ¬¡ã«ã™ã‚‹ã“ã¨ã«å¤‰æ›´
          btn.classList.remove("btn-pattern-active"); // ãƒœã‚¿ãƒ³ã‚’é’è‰²ã«æˆ»ã—ã¾ã™
        }
      }
    </script>
  </body>
</html>
