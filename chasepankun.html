<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>„Éë„É≥„Åè„Çì„ÇíËøΩ„Åà</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            user-select: none;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: Arial, sans-serif;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            padding: 5px;
            gap: 8px;
            overflow-y: auto;
        }
        
        h1 {
            color: white;
            font-size: clamp(18px, 5vw, 36px);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            flex-shrink: 0;
            margin-bottom: 5px;
        }
        
        .title-area {
            flex-shrink: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 15px;
            width: 100%;
        }
        
        .image-container {
            flex-shrink: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .image-container img {
            max-width: 90vw;
            max-height: 100px;
            width: auto;
            height: auto;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        
        .game-wrapper {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 1;
            width: 100%;
            max-height: calc(100vh - 180px);
        }
        
        #gameCanvas {
            border: 3px solid white;
            background-color: #0a0a32;
            display: block;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            max-width: 100vw;
            max-height: 100%;
            width: auto;
            height: auto;
            touch-action: none;
        }
        
        .volume-control {
            flex-shrink: 0;
            background: rgba(0, 0, 0, 0.7);
            padding: 12px 10px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(5px);
        }
        
        .volume-icon {
            color: white;
            font-size: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 24px;
        }
        
        .volume-slider {
            width: 100px;
            height: 6px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #667eea 0%, #667eea 50%, #ccc 50%, #ccc 100%);
            outline: none;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #ffffff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
            border: 2px solid #667eea;
        }
        
        .volume-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #ffffff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
            border: 2px solid #667eea;
        }
        
        .volume-value {
            color: white;
            font-size: 12px;
            font-weight: bold;
            width: 30px;
            text-align: center;
            min-height: 18px;
        }
        
        .instructions {
            color: white;
            font-size: clamp(11px, 2.5vw, 14px);
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 12px;
            border-radius: 6px;
            max-width: 95vw;
            flex-shrink: 0;
            line-height: 1.3;
        }
        
        .instructions p {
            margin: 3px 0;
        }
        
        /* „É¢„Éê„Ç§„É´„Éá„Éê„Ç§„ÇπÂêë„Åë */
        @media (max-width: 480px) {
            .container {
                padding: 4px;
                gap: 6px;
            }
            
            h1 {
                margin-bottom: 3px;
            }
            
            .title-area {
                gap: 10px;
            }
            
            .image-container img {
                max-height: 80px;
            }
            
            .game-wrapper {
                max-height: calc(100vh - 160px);
            }
            
            #gameCanvas {
                border: 2px solid white;
            }
            
            .volume-control {
                padding: 10px 8px;
                gap: 6px;
            }
            
            .volume-slider {
                width: 80px;
            }
            
            .volume-icon {
                font-size: 18px;
            }
            
            .instructions {
                padding: 6px 10px;
                font-size: 11px;
            }
        }
        
        /* „Çø„Éñ„É¨„ÉÉ„ÉàÂêë„Åë */
        @media (min-width: 481px) and (max-width: 1024px) {
            .container {
                padding: 10px;
            }
            
            .image-container img {
                max-height: 120px;
            }
            
            .volume-control {
                padding: 14px 12px;
            }
            
            .volume-slider {
                width: 110px;
            }
        }
        
        /* „Éá„Çπ„ÇØ„Éà„ÉÉ„ÉóÂêë„Åë */
        @media (min-width: 1025px) {
            .container {
                padding: 20px;
            }
            
            .image-container img {
                max-height: 150px;
            }
            
            .volume-control {
                padding: 16px 14px;
            }
            
            .volume-slider {
                width: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>„Éë„É≥„Åè„Çì„ÇíËøΩ„Åà</h1>
        <div class="title-area">
            <div class="image-container">
                <img src="images/kiyo.png" alt="„Åç„Çà„ÅÆ„Ç§„É©„Çπ„Éà">
            </div>
            <div class="volume-control">
                <div class="volume-icon">üîä</div>
                <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="70">
                <div class="volume-value"><span id="volumeValue">70</span>%</div>
            </div>
        </div>
        <div class="game-wrapper">
            <canvas id="gameCanvas"></canvas>
        </div>
        <div class="instructions">
            <p>Âãï„ÅÑ„Å¶„ÅÑ„Çã„Éë„É≥„Åè„Çì„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Çπ„Ç≥„Ç¢„Çí‰∏ä„Åí„Åæ„Åó„Çá„ÅÜ!</p>
            <p>„ÇØ„É™„ÉÉ„ÇØ„Åô„Çã„Åü„Å≥„Å´„Éë„É≥„Åè„Çì„ÅØ„Çπ„Éî„Éº„Éâ„Åå‰∏ä„Åå„Çã„Çà</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const volumeSlider = document.getElementById('volumeSlider');
        const volumeValue = document.getElementById('volumeValue');

        // Game constants
        const GAME_WIDTH = 600;
        const GAME_HEIGHT = 400;

        // Game variables
        let score = 0;
        let spriteX = GAME_WIDTH / 2;
        let spriteY = GAME_HEIGHT / 2;
        let spriteSpeed = [2, 2];
        let spriteRadius = 25;
        let spriteImage = null;
        let scaleX = 1;
        let scaleY = 1;
        let volume = 70;

        // Audio context for sound
        let audioContext = null;
        
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            return audioContext;
        }

        // Play success sound when sprite is clicked
        function playSuccessSound() {
            try {
                const ctx = initAudio();
                const now = ctx.currentTime;
                
                // Create gain node for volume control
                const gainNode = ctx.createGain();
                gainNode.gain.value = (volume / 100) * 0.3;
                gainNode.connect(ctx.destination);
                
                // Create oscillator for the sound
                const osc = ctx.createOscillator();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800, now);
                osc.frequency.exponentialRampToValueAtTime(1200, now + 0.1);
                osc.connect(gainNode);
                
                // Play sound
                osc.start(now);
                osc.stop(now + 0.1);
            } catch (e) {
                console.log('Audio not available:', e);
            }
        }

        // Load the sprite image
        const img = new Image();
        img.src = 'images/pan.png';
        img.onload = function() {
            spriteImage = img;
        };

        // Volume control
        volumeSlider.addEventListener('input', (e) => {
            volume = parseInt(e.target.value);
            volumeValue.textContent = volume;
            
            // Update slider background color based on volume
            const percent = volume;
            volumeSlider.style.background = `linear-gradient(to right, #667eea 0%, #667eea ${percent}%, #ccc ${percent}%, #ccc 100%)`;
        });

        // Initialize volume display
        volumeSlider.style.background = `linear-gradient(to right, #667eea 0%, #667eea 70%, #ccc 70%, #ccc 100%)`;

        // Resize canvas to fit screen
        function resizeCanvas() {
            const container = canvas.parentElement;
            const containerWidth = Math.min(window.innerWidth - 10, GAME_WIDTH);
            const containerHeight = Math.min(window.innerHeight - 200, GAME_HEIGHT);
            
            // Maintain aspect ratio
            const aspectRatio = GAME_WIDTH / GAME_HEIGHT;
            
            let canvasWidth = containerWidth;
            let canvasHeight = containerWidth / aspectRatio;
            
            if (canvasHeight > containerHeight) {
                canvasHeight = containerHeight;
                canvasWidth = canvasHeight * aspectRatio;
            }
            
            canvas.width = Math.max(canvasWidth, 200);
            canvas.height = Math.max(canvasHeight, 133);
            
            scaleX = canvas.width / GAME_WIDTH;
            scaleY = canvas.height / GAME_HEIGHT;
        }

        // Draw function
        function draw() {
            // Clear screen
            ctx.fillStyle = '#0a0a32';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw score
            ctx.fillStyle = 'white';
            const fontSize = Math.max(16, canvas.width / 20);
            ctx.font = `bold ${fontSize}px Arial`;
            ctx.fillText(`Score: ${score}`, canvas.width * 0.03, fontSize + 10);

            // Draw sprite
            const drawX = spriteX * scaleX;
            const drawY = spriteY * scaleY;
            const spriteSize = 100 * Math.min(scaleX, scaleY);

            if (spriteImage) {
                ctx.drawImage(spriteImage, drawX - spriteSize / 2, drawY - spriteSize / 2, spriteSize, spriteSize);
            } else {
                // Fallback: yellow circle
                ctx.fillStyle = 'yellow';
                ctx.beginPath();
                ctx.arc(drawX, drawY, spriteRadius * Math.min(scaleX, scaleY), 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Update function
        function update() {
            spriteX += spriteSpeed[0];
            spriteY += spriteSpeed[1];

            // Bounce off walls
            if (spriteX < 50 || spriteX > GAME_WIDTH - 50) {
                spriteSpeed[0] *= -1;
            }
            if (spriteY < 50 || spriteY > GAME_HEIGHT - 50) {
                spriteSpeed[1] *= -1;
            }
        }

        // Get click position
        function getClickPos(event) {
            const rect = canvas.getBoundingClientRect();
            let clientX, clientY;
            
            if (event.touches && event.touches.length > 0) {
                clientX = event.touches[0].clientX;
                clientY = event.touches[0].clientY;
            } else if (event.changedTouches && event.changedTouches.length > 0) {
                clientX = event.changedTouches[0].clientX;
                clientY = event.changedTouches[0].clientY;
            } else {
                clientX = event.clientX;
                clientY = event.clientY;
            }
            
            const clickX = (clientX - rect.left) / scaleX;
            const clickY = (clientY - rect.top) / scaleY;
            
            return { x: clickX, y: clickY };
        }

        // Click/Touch handler
        function handleClick(event) {
            const pos = getClickPos(event);
            
            // Check if click is on sprite
            const dist = Math.sqrt(Math.pow(pos.x - spriteX, 2) + Math.pow(pos.y - spriteY, 2));

            if (dist < 35) {
                score += 1;
                spriteX = Math.random() * (GAME_WIDTH - 100) + 50;
                spriteY = Math.random() * (GAME_HEIGHT - 100) + 50;
                spriteSpeed[0] *= 1.05;
                spriteSpeed[1] *= 1.05;
                
                // Play success sound
                playSuccessSound();
            }
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        canvas.addEventListener('click', handleClick, false);
        canvas.addEventListener('touchend', handleClick, false);

        // Game loop
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Initialize
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        gameLoop();
    </script>
</body>
</html>
